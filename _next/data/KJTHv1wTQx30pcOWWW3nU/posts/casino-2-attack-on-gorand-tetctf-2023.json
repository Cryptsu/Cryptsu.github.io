{"pageProps":{"frontMatter":{"title":"Casino 2 - Attack on gorand - TETCTF-2023","date":"2023-01-10T03:26:00+07:00","description":"Sometimes random has a pattern...","coverImage":"cover.jpg","minsRead":21,"draft":false,"noWords":4104,"permalink":"https://cryptsu.github.io/posts/casino-2-attack-on-gorand-tetctf-2023/","slug":"casino-2-attack-on-gorand-tetctf-2023"},"sourceContent":{"compiledSource":"const{Fragment:a,jsx:s,jsxs:n}=arguments[0],l=arguments[0][\"useMDXComponents\"];function c(e){e=Object.assign({p:\"p\",em:\"em\",blockquote:\"blockquote\",strong:\"strong\",a:\"a\",span:\"span\",math:\"math\",semantics:\"semantics\",mrow:\"mrow\",mfrac:\"mfrac\",mn:\"mn\",annotation:\"annotation\",div:\"div\",h1:\"h1\",hr:\"hr\",code:\"code\",mi:\"mi\",mo:\"mo\",msup:\"msup\",msub:\"msub\",mspace:\"mspace\",mtext:\"mtext\",img:\"img\",ul:\"ul\",li:\"li\",pre:\"pre\",h2:\"h2\",h3:\"h3\"},l(),e.components);return n(a,{children:[s(e.p,{children:s(e.em,{children:\"(flashback)\"})}),\"\\n\",n(e.blockquote,{children:[\"\\n\",n(e.p,{children:[s(e.strong,{children:\"Me\"}),\": Hey, I think this challenge uses a faulty version of \",s(e.em,{children:s(e.a,{href:\"https://github.com/cosmos/iavl\",children:\"cosmos/iavl\"})}),\". Cuz you know, like, according to the \",s(e.em,{children:\"go.mod\"}),\" file, it uses \",s(e.strong,{children:\"v0.19.2\"}),\", which is not the latest version. And then there is this \",s(e.a,{href:\"https://github.com/cosmos/iavl/blob/master/CHANGELOG.md\",children:\"change log\"}),\" of version \",s(e.strong,{children:\"v0.19.3\"}),\" saying it prevent sth sth and then there is this \",s(e.a,{href:\"https://sanebow.me/bnb-hack-iavl-explained\",children:\"blog page\"}),\" posted around that release saying \",s(e.em,{children:\"iavl\"}),\" is not good etc etc. I think this is the vulnerability.\"]}),\"\\n\"]}),\"\\n\",n(e.blockquote,{children:[\"\\n\",n(e.p,{children:[s(e.strong,{children:\"L.T.\"}),\": I think \",s(e.em,{children:\"ndh\"}),\" doesn't want to tease our brain too hard, so he wouldn't come up with sth this complex. Let's crack the random function.\"]}),\"\\n\"]}),\"\\n\",n(e.blockquote,{children:[\"\\n\",n(e.p,{children:[s(e.strong,{children:\"Me\"}),\": I agree. There are so many words and crazy stuffs in this blog so it's probably isn't true.\"]}),\"\\n\"]}),\"\\n\",n(e.blockquote,{children:[\"\\n\",n(e.p,{children:[s(e.strong,{children:\"L.T.\"}),\": Yeah...\"]}),\"\\n\"]}),\"\\n\",n(e.blockquote,{children:[\"\\n\",n(e.p,{children:[s(e.strong,{children:\"Me\"}),\": Yeah...\"]}),\"\\n\"]}),\"\\n\",n(e.p,{children:[\"Well, that turns out to be the intended vulnerability of the challenge. But we're not here to discuss that \",s(e.em,{children:\"(that blog still hurts my brain btw :'()\"}),\" because we actually figured out a way to crack the random function :happy: \",s(e.em,{children:\"(yey)\"})]}),\"\\n\",n(e.p,{children:[\"I've seen the discussion around the challenge and I saw players talking about brute-forcing with multiple cores to get the seed of Go's PRNG. Well, we actually found a way to predict the result without having to find the seed \",\"üòó\"]}),\"\\n\",n(e.p,{children:[\"Although this approach only gives us the correct output \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.mfrac,{children:[s(e.mn,{children:\"1\"}),s(e.mn,{children:\"4\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\frac{1}{4}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.1901em\",verticalAlign:\"-0.345em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mopen nulldelimiter\"}),s(e.span,{className:\"mfrac\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[n(e.span,{className:\"vlist\",style:{height:\"0.8451em\"},children:[n(e.span,{style:{top:\"-2.655em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"4\"})})})]}),n(e.span,{style:{top:\"-3.23em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),s(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),n(e.span,{style:{top:\"-3.394em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.345em\"},children:s(e.span,{})})})]})}),s(e.span,{className:\"mclose nulldelimiter\"})]})]})})]})}),\" of the time, I still think it is interesting so it would be fun to share it \",\"üôÇ\"]}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",s(e.h1,{id:\"tldr\",children:\"TL;DR\"}),\"\\n\",s(e.hr,{}),\"\\n\",s(e.p,{children:n(e.strong,{children:[\"‚ö†Ô∏è\",\" (Because I want to write a blog about the details of my discovery, including methods to find it, other methods you can go, what's the challenge is all about, etc, ..., this blog will be a very, probably unnecessarily, lengthy one, and if you're not ready to read it, here is a small recap on what's about to come \",\"üôÇ\",\")\",\"‚ö†Ô∏è\"]})}),\"\\n\",n(e.blockquote,{children:[\"\\n\",s(e.p,{children:s(e.em,{children:\"(now come to think of it I might have put the whole stream of consciousness in here...)\"})}),\"\\n\"]}),\"\\n\",s(e.hr,{}),\"\\n\",n(e.p,{children:[s(e.div,{}),\"\\nConsider a list of outputs from \",s(e.code,{children:\"rand.Intn(n)\"}),\" named \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"R\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"R\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"})]})})]})}),\" where \",s(e.code,{children:\"n\"}),\" is a relatively small number \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{children:\"<\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"< 2^{31}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),s(e.span,{className:\"mrel\",children:\"<\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]})]})]})]})}),\". The \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"i\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"i\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6595em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"i\"})]})})]})}),\"-th element \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"R_i\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]})]})})]})}),\" will most likely fall into one of these 4 cases:\"]}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"}),s(e.mspace,{linebreak:\"newline\"}),s(e.mtext,{children:\"or\"}),s(e.mspace,{linebreak:\"newline\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mo,{children:\"+\"}),s(e.mn,{children:\"1\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"}),s(e.mspace,{linebreak:\"newline\"}),s(e.mtext,{children:\"or\"}),s(e.mspace,{linebreak:\"newline\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mo,{children:\"‚àí\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"}),s(e.mspace,{linebreak:\"newline\"}),s(e.mtext,{children:\"or\"}),s(e.mspace,{linebreak:\"newline\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mo,{children:\"‚àí\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mo,{children:\"+\"}),s(e.mn,{children:\"1\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"R_i = R_{i-607} + R_{i-273} \\\\mod {n}\\n\\\\\\\\ \\\\text{or} \\\\\\\\\\nR_i = R_{i-607} + R_{i-273} + 1 \\\\mod {n}\\n\\\\\\\\ \\\\text{or} \\\\\\\\\\nR_i = R_{i-607} + R_{i-273} - 2^{31} \\\\mod {n}\\n\\\\\\\\ \\\\text{or} \\\\\\\\\\nR_i = R_{i-607} + R_{i-273} - 2^{31} + 1 \\\\mod {n}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord text\",children:s(e.span,{className:\"mord\",children:\"or\"})})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"1\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord text\",children:s(e.span,{className:\"mord\",children:\"or\"})})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"‚àí\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8641em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord text\",children:s(e.span,{className:\"mord\",children:\"or\"})})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"‚àí\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.9474em\",verticalAlign:\"-0.0833em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"1\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]})]})]})})}),\"\\n\",n(e.p,{children:[\"and we use \",s(e.strong,{children:\"one of these 4 equations as our strategy to guess the next output\"}),\". Each round we bet \",s(e.code,{children:\"balance\"}),s(e.strong,{children:\"/2\"}),\" (\",n(e.em,{children:[\"or some number that is linear to \",s(e.code,{children:\"balance\"}),\", like \",s(e.code,{children:\"balance\"}),s(e.strong,{children:\"/3\"}),\" or sth, your pick \",\"üòô\"]}),\"). This strategy allows our money not to run out too quickly when we guess the wrong number while still guarantees our money growing exponentially if we win. Since \",s(e.strong,{children:\"win amount\"}),\" is \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{children:\">\"}),s(e.mo,{children:\">\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\">>\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),s(e.span,{className:\"mrel\",children:\">>\"})]})})]})}),\" \",s(e.strong,{children:\"lose amount\"}),\", we will benefit in the long run and hence can reach our target \",s(e.code,{children:\"balance\"}),\".\"]}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",s(e.h1,{id:\"challenge-description\",children:\"Challenge description\"}),\"\\n\",n(e.blockquote,{children:[\"\\n\",s(e.p,{children:n(e.em,{children:[\"(if you know all the functionalities of the code files, you may skip this section anyways \",\"üôÇ\",\" )\"]})}),\"\\n\"]}),\"\\n\",s(e.p,{children:\"This challenge is about a Go Application that emulates some sort of online casino stuffs. You interact with the server by sending some JSON data as input, and expect some text data as output.\"}),\"\\n\",s(e.img,{src:\"example-command.png\",alt:\"\"}),\"\\n\",s(e.p,{children:\"You can:\"}),\"\\n\",n(e.ul,{children:[\"\\n\",n(e.li,{children:[\"\\n\",n(e.p,{children:[s(e.strong,{children:\"register\"}),\" your \",s(e.code,{children:\"username\"}),\" and get \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"2023\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2023\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"2023\"})]})})]})}),\" coin units as your initial \",s(e.code,{children:\"balance\"}),\". The server also restricts you from registering more than \",s(e.strong,{children:\"100 accounts\"}),\" or creates another account with an existing \",s(e.code,{children:\"username\"}),\", but it doesn't matter in the context of solving this challenge anyways.\"]}),\"\\n\"]}),\"\\n\",n(e.li,{children:[\"\\n\",s(e.p,{children:s(e.em,{children:s(\"u\",{children:s(e.strong,{children:\"example request:\"})})})}),\"\\n\"]}),\"\\n\"]}),\"\\n\",s(e.pre,{className:\"language-json\",children:s(e.code,{className:\"language-json code-highlight\",children:n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",s(e.span,{className:\"token property\",children:'\"recipient\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Casino\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"command\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Register\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"username\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Orrrrrr\"'}),\" \",s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]})})}),\"\\n\",n(e.ul,{children:[\"\\n\",s(e.li,{children:s(e.em,{children:s(\"u\",{children:s(e.strong,{children:\"code:\"})})})}),\"\\n\"]}),\"\\n\",s(e.pre,{className:\"language-go\",children:n(e.code,{className:\"language-go code-highlight\",children:[n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// casino.go\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"const\"}),\" MaxPlayers \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token number\",children:\"100\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"const\"}),\" InitialBalance \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token number\",children:\"2023\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"func\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"c \",s(e.span,{className:\"token operator\",children:\"*\"}),\"Casino\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token function\",children:\"Register\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username \",s(e.span,{className:\"token builtin\",children:\"string\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token builtin\",children:\"error\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"exist\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",s(e.span,{className:\"token operator\",children:\":=\"}),\" c\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"tree\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Has\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token function\",children:\"byte\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",s(e.span,{className:\"token operator\",children:\"!=\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    log\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Fatal\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"err\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" exist \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" errors\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"New\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"player-exists\"'}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" c\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"numAccounts \",s(e.span,{className:\"token operator\",children:\">=\"}),\" MaxPlayers \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" errors\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"New\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"max-players\"'}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"c\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"numAccounts \",s(e.span,{className:\"token operator\",children:\"+=\"}),\" \",s(e.span,{className:\"token number\",children:\"1\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"c\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"setBalance\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" big\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"NewInt\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"InitialBalance\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"fmt\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Printf\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"Added user: %s.\\\\n\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" username\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"return\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]})]})}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",n(e.ul,{children:[\"\\n\",n(e.li,{children:[\"\\n\",n(e.p,{children:[s(e.strong,{children:\"bet\"}),\" a number \",s(e.code,{children:\"n\"}),\" between \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{stretchy:\"false\",children:\"[\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),s(e.mn,{children:\"2023\"}),s(e.mo,{stretchy:\"false\",children:\")\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"[0, 2023)\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"[\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord\",children:\"2023\"}),s(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" with some non-negative \",s(e.code,{children:\"amount\"}),\" (\",n(e.em,{children:[\"if you put in a negative number, the server will correct it to become positive anyways \",\"ü§ß\",\"  -- this became the exploit point of the first challenge, Casino 1, because it didn't check whether the amount is negative or not.\"]}),\")\"]}),\"\\n\",n(e.p,{children:[\"The server also generates a number \",s(e.code,{children:\"n\"}),\" between \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{stretchy:\"false\",children:\"[\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),s(e.mn,{children:\"2023\"}),s(e.mo,{stretchy:\"false\",children:\")\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"[0, 2023)\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"[\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord\",children:\"2023\"}),s(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\". If your \",s(e.code,{children:\"n\"}),\" \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mo,{mathvariant:\"normal\",children:\"‚â†\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\neq\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),n(e.span,{className:\"mrel\",children:[s(e.span,{className:\"mrel\",children:s(e.span,{className:\"mord vbox\",children:s(e.span,{className:\"thinbox\",children:n(e.span,{className:\"rlap\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),s(e.span,{className:\"inner\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mrel\",children:\"ÓÄ†\"})})}),s(e.span,{className:\"fix\"})]})})})}),s(e.span,{className:\"mrel\",children:\"=\"})]})]})})]})}),\" server's \",s(e.code,{children:\"n\"}),\", you will lose :<, else you will win :>\"]}),\"\\n\",n(e.ul,{children:[\"\\n\",n(e.li,{children:[s(e.em,{children:\"when you lose\"}),\", you lose \",s(e.code,{children:\"amount\"}),\" and you will have \",s(e.code,{children:\"balance\"}),\" -¬†\",s(e.code,{children:\"amount\"}),\" coin units left.\"]}),\"\\n\",n(e.li,{children:[s(e.em,{children:\"when you win\"}),\", you gain \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"2022\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2022\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"2022\"})]})})]})}),\" * \",s(e.code,{children:\"amount\"}),\".\"]}),\"\\n\"]}),\"\\n\",n(e.p,{children:[\"Also, the server will tell you \",n(e.strong,{children:[\"what \",s(e.code,{children:\"n\"}),\" they generated\"]}),\". \",s(e.em,{children:\"( <- This will become important later on )\"})]}),\"\\n\"]}),\"\\n\",n(e.li,{children:[\"\\n\",s(e.p,{children:s(e.strong,{children:s(\"u\",{children:s(e.em,{children:\"example request:\"})})})}),\"\\n\"]}),\"\\n\"]}),\"\\n\",s(e.pre,{className:\"language-json\",children:s(e.code,{className:\"language-json code-highlight\",children:n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",s(e.span,{className:\"token property\",children:'\"recipient\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Casino\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"command\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Bet\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"username\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Orrrrrr\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"amount\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token number\",children:\"123\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"n\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token number\",children:\"456\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]})})}),\"\\n\",n(e.ul,{children:[\"\\n\",n(e.li,{children:[\"\\n\",s(\"u\",{children:s(e.em,{children:s(e.strong,{children:\"code:\"})})}),\"\\n\"]}),\"\\n\"]}),\"\\n\",s(e.pre,{className:\"language-go\",children:n(e.code,{className:\"language-go code-highlight\",children:[n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// casino.go\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"func\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"c \",s(e.span,{className:\"token operator\",children:\"*\"}),\"Casino\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token function\",children:\"Bet\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username \",s(e.span,{className:\"token builtin\",children:\"string\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" amount \",s(e.span,{className:\"token operator\",children:\"*\"}),\"big\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"Int\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" n \",s(e.span,{className:\"token builtin\",children:\"int\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token builtin\",children:\"error\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"currentBalance\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",s(e.span,{className:\"token operator\",children:\":=\"}),\" c\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"getBalance\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",s(e.span,{className:\"token operator\",children:\"!=\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" err\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"amount\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Abs\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"amount\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" currentBalance\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Cmp\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"amount\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"<\"}),\" \",s(e.span,{className:\"token number\",children:\"0\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" errors\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"New\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"insufficient-balance\"'}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"r \",s(e.span,{className:\"token operator\",children:\":=\"}),\" rand\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Intn\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"2023\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" r \",s(e.span,{className:\"token operator\",children:\"==\"}),\" n \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",s(e.span,{className:\"token comment\",children:\"// correct guess\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    reward \",s(e.span,{className:\"token operator\",children:\":=\"}),\" \",s(e.span,{className:\"token function\",children:\"new\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"big\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"Int\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Mul\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"amount\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" big\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"NewInt\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"2022\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    currentBalance\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Add\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"currentBalance\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" reward\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    c\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"setBalance\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" currentBalance\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    fmt\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Printf\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"YOU WIN! Current balance: %d (+%d).\\\\n\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" currentBalance\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" reward\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",s(e.span,{className:\"token keyword\",children:\"else\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    currentBalance\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Sub\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"currentBalance\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" amount\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    c\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"setBalance\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" currentBalance\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    fmt\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Printf\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"YOU LOSE (%d != %d)! Current balance: %d (-%d).\\\\n\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" r\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" n\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" currentBalance\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" amount\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"return\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]})]})}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",n(e.ul,{children:[\"\\n\",n(e.li,{children:[\"\\n\",n(e.p,{children:[s(e.strong,{children:\"show balance with proof\"}),\": You give your \",s(e.code,{children:\"username\"}),\" to the server and it gives you the \",s(e.code,{children:\"balance\"}),\" along with a \",s(e.code,{children:\"proofData\"}),\" to prove that you actually own that amount of money.\"]}),\"\\n\"]}),\"\\n\",n(e.li,{children:[\"\\n\",s(e.p,{children:s(e.strong,{children:s(\"u\",{children:s(e.em,{children:\"example request:\"})})})}),\"\\n\"]}),\"\\n\"]}),\"\\n\",s(e.pre,{className:\"language-json\",children:s(e.code,{className:\"language-json code-highlight\",children:n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"{\"}),s(e.span,{className:\"token property\",children:'\"Recipient\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Casino\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"Command\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"ShowBalanceWithProof\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"Username\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Orrrrrr\"'}),s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]})})}),\"\\n\",n(e.ul,{children:[\"\\n\",s(e.li,{children:s(e.em,{children:s(e.strong,{children:s(\"u\",{children:\"code:\"})})})}),\"\\n\"]}),\"\\n\",s(e.pre,{className:\"language-go\",children:n(e.code,{className:\"language-go code-highlight\",children:[n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// casino.go\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"func\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"c \",s(e.span,{className:\"token operator\",children:\"*\"}),\"Casino\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token function\",children:\"ShowBalanceWithProof\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username \",s(e.span,{className:\"token builtin\",children:\"string\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token builtin\",children:\"error\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"value\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" proof\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",s(e.span,{className:\"token operator\",children:\":=\"}),\" c\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"tree\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"GetWithProof\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token function\",children:\"byte\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",s(e.span,{className:\"token operator\",children:\"!=\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    log\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Fatal\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"err\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" value \",s(e.span,{className:\"token operator\",children:\"==\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" errors\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"New\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"player-not-exist\"'}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"proofData\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",s(e.span,{className:\"token operator\",children:\":=\"}),\" proof\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"ToProto\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Marshal\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",s(e.span,{className:\"token operator\",children:\"!=\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    log\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Fatal\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"err\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"fmt\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Printf\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"%d, %s\\\\n\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token function\",children:\"new\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"big\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"Int\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"SetBytes\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"value\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" base64\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"StdEncoding\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"EncodeToString\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"proofData\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"return\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]})]})}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",n(e.ul,{children:[\"\\n\",n(e.li,{children:[\"\\n\",n(e.p,{children:[s(e.strong,{children:\"get the flag\"}),\". In order to retrieve the flag, we need to provide our \",s(e.code,{children:\"balance\"}),\". We also need to provide a \",s(e.code,{children:\"proofData\"}),\", which is generated from the previous section and it's there so that we cannot lie about our \",s(e.code,{children:\"balance\"}),\". The more \",s(e.code,{children:\"balance\"}),\" we have, the more bytes of the flag is revealed to us.\"]}),\"\\n\"]}),\"\\n\",n(e.li,{children:[\"\\n\",s(e.p,{children:s(e.strong,{children:s(\"u\",{children:s(e.em,{children:\"example request:\"})})})}),\"\\n\"]}),\"\\n\"]}),\"\\n\",s(e.pre,{className:\"language-json\",children:s(e.code,{className:\"language-json code-highlight\",children:n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"{\"}),s(e.span,{className:\"token property\",children:'\"Recipient\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"FlagSeller\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"Command\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"PrintFlag\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"Username\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Orrrrrr\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"Balance\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token number\",children:\"674575536530165491749660868130299036066707815144061494924879197906525335081820072153268675251126472982500904339158951753600\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token property\",children:'\"proof_data\"'}),s(e.span,{className:\"token operator\",children:\":\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token number\",children:\"26\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"46\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"10\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"7\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"79\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"114\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"114\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"114\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"114\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"114\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"114\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"18\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"32\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"109\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"131\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"92\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"77\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"137\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"187\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"133\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"233\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"12\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"114\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"115\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"54\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"175\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"113\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"149\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"190\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"174\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"14\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"165\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"57\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"118\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"134\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"67\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"152\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"122\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"170\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"139\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"119\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"113\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"127\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"202\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"200\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"24\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"186\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"6\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]})})}),\"\\n\",n(e.ul,{children:[\"\\n\",s(e.li,{children:s(e.em,{children:s(e.strong,{children:s(\"u\",{children:\"code:\"})})})}),\"\\n\"]}),\"\\n\",s(e.pre,{className:\"language-go\",children:n(e.code,{className:\"language-go code-highlight\",children:[n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// flag_seller.go\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"func\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"fs \",s(e.span,{className:\"token operator\",children:\"*\"}),\"FlagSeller\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token function\",children:\"PrintFlag\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"usename \",s(e.span,{className:\"token builtin\",children:\"string\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" balance \",s(e.span,{className:\"token operator\",children:\"*\"}),\"big\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"Int\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" proofData \",s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token builtin\",children:\"byte\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token builtin\",children:\"error\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"var\"}),\" pbProof iavlproto\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"RangeProof\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",s(e.span,{className:\"token operator\",children:\":=\"}),\" proto\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Unmarshal\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"proofData\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token operator\",children:\"&\"}),\"pbProof\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\";\"}),\" err \",s(e.span,{className:\"token operator\",children:\"!=\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" fmt\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Errorf\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"bad proof format: %w\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"proof\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",s(e.span,{className:\"token operator\",children:\":=\"}),\" iavl\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"RangeProofFromProto\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token operator\",children:\"&\"}),\"pbProof\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",s(e.span,{className:\"token operator\",children:\"!=\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" fmt\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Errorf\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"bad proof format: %w\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",s(e.span,{className:\"token operator\",children:\":=\"}),\" proof\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Verify\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"fs\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"dbRootRetriever\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\";\"}),\" err \",s(e.span,{className:\"token operator\",children:\"!=\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" fmt\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Errorf\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"proof verification failed: %w\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",s(e.span,{className:\"token operator\",children:\":=\"}),\" proof\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"VerifyItem\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token function\",children:\"byte\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"usename\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" balance\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Bytes\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\";\"}),\" err \",s(e.span,{className:\"token operator\",children:\"!=\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" fmt\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Errorf\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"proof verification failed: %w\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"l \",s(e.span,{className:\"token operator\",children:\":=\"}),\" balance\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"BitLen\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"/\"}),\" \",s(e.span,{className:\"token number\",children:\"8\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"dot3 \",s(e.span,{className:\"token operator\",children:\":=\"}),\" \",s(e.span,{className:\"token string\",children:'\"...\"'}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"if\"}),\" l \",s(e.span,{className:\"token operator\",children:\">=\"}),\" \",s(e.span,{className:\"token function\",children:\"len\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"fs\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"flag\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    l \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token function\",children:\"len\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"fs\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"flag\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    dot3 \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token string\",children:'\"\"'}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"fmt\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Printf\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:'\"Your flag is: %s%s\\\\n\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" fs\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"flag\",s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"l\",s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" dot3\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"return\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]})]})}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",s(e.h1,{id:\"analysis\",children:\"Analysis\"}),\"\\n\",n(e.p,{children:[\"The number of flag bytes revealed to us scales linearly with the number of \",s(e.strong,{children:\"bytes\"}),\" there are in our \",s(e.code,{children:\"balance\"}),\", so we probably need to have a lot of money to get the full flag. \",s(e.strong,{children:\"For example\"}),\", if the flag is \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"50\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"50\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"50\"})]})})]})}),\" bytes long, we need at least \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msup,{children:[s(e.mn,{children:\"2\"}),n(e.mrow,{children:[s(e.mn,{children:\"50\"}),s(e.mo,{children:\"‚àó\"}),s(e.mn,{children:\"8\"})]})]}),s(e.mo,{children:\"=\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"400\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2^{50*8} = 2^{400}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mtight\",children:\"50\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àó\"}),s(e.span,{className:\"mord mtight\",children:\"8\"})]})})]})})})})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"400\"})})})]})})})})})]})]})]})]})}),\" coin units to get all of it, which is a really really really big number comparing to our humble \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"2023\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2023\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"2023\"})]})})]})}),\" coins at the beginning.\"]}),\"\\n\",s(e.p,{children:\"There are two ways we may want to approach this problem.\"}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",s(e.h2,{id:\"the-iavl-bug\",children:\"The IAVL bug\"}),\"\\n\",n(e.p,{children:[\"First one is the \",s(e.strong,{children:\"IAVL bug\"}),\". You can see that users' data is stored in the \",s(e.code,{children:\"Casino\"}),\" structure, which contains a \",s(e.code,{children:\"tree\"}),\" object. This \",s(e.code,{children:\"tree\"}),\" data type comes from \",s(e.code,{children:\"github.com/cosmos/iavl\"}),\" library.\"]}),\"\\n\",s(e.pre,{className:\"language-go\",children:n(e.code,{className:\"language-go code-highlight\",children:[n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// casino.go\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"import\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token string\",children:'\"github.com/cosmos/iavl\"'}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"type\"}),\" Casino \",s(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\ttree        \",s(e.span,{className:\"token operator\",children:\"*\"}),\"iavl\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"MutableTree\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\tnumAccounts \",s(e.span,{className:\"token builtin\",children:\"int\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"    \\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"func\"}),\" \",s(e.span,{className:\"token function\",children:\"NewCasino\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"*\"}),\"Casino \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\ttree\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",s(e.span,{className:\"token operator\",children:\":=\"}),\" iavl\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"NewMutableTree\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"NewMemDB\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"128\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token boolean\",children:\"true\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",s(e.span,{className:\"token operator\",children:\"!=\"}),\" \",s(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\\tlog\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Fatal\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"err\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]})]})}),\"\\n\",n(e.p,{children:[\"Upon inspecting the \",s(e.code,{children:\"go.mod\"}),\" file, you can see that it uses version \",s(e.code,{children:\"v0.19.2\"}),\", which is nothing surprising until you find out that the real-world \",s(e.code,{children:\"IAVL\"}),\" is version \",s(e.code,{children:\"v0.19.4\"}),\" by the time the challenge was released.\"]}),\"\\n\",s(e.pre,{className:\"language-go\",children:n(e.code,{className:\"language-go code-highlight\",children:[n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// go.mod\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),s(e.span,{className:\"code-line\",children:\"module casino\\n\"}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"go\"}),\" \",s(e.span,{className:\"token number\",children:\"1.19\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"require \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\tgithub\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"com\",s(e.span,{className:\"token operator\",children:\"/\"}),\"cosmos\",s(e.span,{className:\"token operator\",children:\"/\"}),\"iavl v0\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token number\",children:\"19.2\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\tgithub\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"com\",s(e.span,{className:\"token operator\",children:\"/\"}),\"golang\",s(e.span,{className:\"token operator\",children:\"/\"}),\"protobuf v1\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token number\",children:\"5.2\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\tgithub\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"com\",s(e.span,{className:\"token operator\",children:\"/\"}),\"tendermint\",s(e.span,{className:\"token operator\",children:\"/\"}),\"tm\",s(e.span,{className:\"token operator\",children:\"-\"}),\"db v0\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token number\",children:\"6.6\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]})]})}),\"\\n\",n(e.p,{children:[\"So, I began searching for clues, like \",s(e.em,{children:'\"iavl v0.19.2 attack\"'}),\", \",s(e.em,{children:'\"cosmos iavl v0.19.2 tree vulnerability attack\"'}),\", then I came upon this blog:\"]}),\"\\n\",s(e.img,{src:\"vuln-search.png\",alt:\"\"}),\"\\n\",n(e.p,{children:[\"which was suspicious, because it released around the time of \",s(e.code,{children:\"v0.19.3\"}),\" according to this \",s(e.a,{href:\"https://github.com/cosmos/iavl/releases\",children:\"change log\"}),\". \",s(e.strong,{children:'\" Pass IAVL Proof Verification?\"'}),\" Maybe there's some way we can craft a fake \",s(e.code,{children:\"proofData\"}),\" to send to the \",s(e.code,{children:\"PrintFlag\"}),\" function for any \",s(e.code,{children:\"balance\"}),\" we wish to? Anyways, reading through the blog \",n(e.em,{children:[\"(not the one I screenshot-ed above, \",n(e.a,{href:\"https://sanebow.me/bnb-hack-iavl-explained\",children:[\"this one, dunno why it's not in Google search anymore \",\"üòï\"]}),\" that one's just for showcase that we tried to find stuffs)\"]}),\", it seems like whatever bug they found, it was really bad. So I thought to myself: \",s(e.strong,{children:\"This must be it\"}),\".\"]}),\"\\n\",n(e.p,{children:[\"Then I noticed the change in \",s(e.code,{children:\"v0.19.3\"}),\", it seems like the change in the newer version suggests something about the attack we should come up with :)\"]}),\"\\n\",s(e.img,{src:\"change-log-to-attack.png\",alt:\"\"}),\"\\n\",n(e.p,{children:[\"However, our investigation about the tree stuff ends here, because this is where me and my teammate stopped \",n(e.em,{children:[\"(you know why \",\"üôÇ\",\")\"]}),\"; and also this blog's about attacking the Go's \",s(e.code,{children:\"rand\"}),\" stuff \",\"üòó\",\" If you want to read more about the \",s(e.strong,{children:\"IAVL bug\"}),\", you should visit these two links, provided by a fellow Discord member:\"]}),\"\\n\",n(e.ul,{children:[\"\\n\",s(e.li,{children:s(e.a,{href:\"https://blog.verichains.io/p/binance-bridge-exploitation-preliminary\",children:\"Binance Chain Bridge Exploitation Writeup - Part 1\"})}),\"\\n\",s(e.li,{children:s(e.a,{href:\"https://blog.verichains.io/p/binance-chain-bridge-exploitation\",children:\"Binance Chain Bridge Exploitation Writeup - Part 2\"})}),\"\\n\"]}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",n(e.h2,{id:\"the-go-mathrand-stuff\",children:[\"The Go \",s(e.code,{children:\"math/rand\"}),\" stuff\"]}),\"\\n\",n(e.p,{children:[\"The second way you could dig at this challenge is by exploiting the \",s(e.code,{children:\"rand.Intn(n)\"}),\" function from \",s(e.code,{children:\"math/rand\"}),\" library. Remember, the server creates random numbers in \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{stretchy:\"false\",children:\"[\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),s(e.mn,{children:\"2023\"}),s(e.mo,{stretchy:\"false\",children:\")\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"[0, 2023)\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"[\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord\",children:\"2023\"}),s(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" and you can try to guess them in order to gain/or lose money.\"]}),\"\\n\",n(e.p,{children:[\"We can try to go all random; however, that only guarantees us to get the correct answer in a probability of \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.mfrac,{children:[s(e.mn,{children:\"1\"}),s(e.mn,{children:\"2023\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\frac{1}{2023}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.1901em\",verticalAlign:\"-0.345em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mopen nulldelimiter\"}),s(e.span,{className:\"mfrac\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[n(e.span,{className:\"vlist\",style:{height:\"0.8451em\"},children:[n(e.span,{style:{top:\"-2.655em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"2023\"})})})]}),n(e.span,{style:{top:\"-3.23em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),s(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),n(e.span,{style:{top:\"-3.394em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.345em\"},children:s(e.span,{})})})]})}),s(e.span,{className:\"mclose nulldelimiter\"})]})]})})]})}),\", and from the way the server rewards us, \",s(e.strong,{children:\"+\"}),s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"2022\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2022\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"2022\"})]})})]})}),\" * \",s(e.code,{children:\"balance\"}),\" for winning and \",s(e.strong,{children:\"-\"}),s(e.code,{children:\"balance\"}),\" for losing, it seems like we will just be stuck in the same loop forever if we do that.\"]}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",s(e.hr,{}),\"\\n\",s(e.p,{children:\"If only somehow you can find a hidden pattern in the way the server generates the numbers, which is just this line of code btw :333\"}),\"\\n\",s(e.pre,{className:\"language-go\",children:s(e.code,{className:\"language-go code-highlight\",children:n(e.span,{className:\"code-line\",children:[\"r \",s(e.span,{className:\"token operator\",children:\":=\"}),\" rand\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Intn\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"2023\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]})})}),\"\\n\",n(e.p,{children:[\"then you can use it to predict future values, keep winning and rocketing yourself to your target \",s(e.code,{children:\"balance\"}),\". And from the title, you already know that it is possible.\"]}),\"\\n\",n(e.p,{children:[\"The reason this is feasible because the \",s(e.code,{children:\"math/rand\"}),\" library \",s(e.em,{children:s(\"u\",{children:'\"implements pseudo-random number generators\"'})}),\" which is \",s(e.em,{children:s(\"u\",{children:'\"unsuitable for security-sensitive work\"'})}),\" according to \",s(e.a,{href:\"https://pkg.go.dev/math/rand\",children:\"this link\"}),\". It also states that \",s(e.em,{children:s(\"u\",{children:\"\\\"This package's outputs might be easily predictable regardless of how it's seeded.\\\"\"})}),\" Great! But how predictable is it?\"]}),\"\\n\",s(e.hr,{}),\"\\n\",n(e.p,{children:[s(e.div,{}),\"\\nA \",s(e.strong,{children:\"pseudo-random number generator\"}),\", or \",s(e.strong,{children:\"PRNG\"}),\", like this would generate all of their supposed random numbers based on a \",s(e.code,{children:\"seed\"}),\" value. If you know the \",s(e.code,{children:\"seed\"}),\", you basically become god and predict all \",s(e.code,{children:\"n\"}),\" values in the bet game.\"]}),\"\\n\",n(e.p,{children:[\"As some players have pointed out, it is possible to recover the \",s(e.code,{children:\"seed\"}),\" of Go's PRNG, because:\"]}),\"\\n\",s(e.img,{src:\"player-discussion-seed.png\",alt:\"\"}),\"\\n\",n(e.p,{children:[\"This means we just need to brute-force every value from \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"0\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"0\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"0\"})]})})]})}),\" to \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"32\"})]}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"1\"}),s(e.mo,{children:\"=\"}),s(e.mn,{children:\"4294967295\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2^{32} - 1 = 4294967295\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8974em\",verticalAlign:\"-0.0833em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"32\"})})})]})})})})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"‚àí\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"1\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"4294967295\"})]})]})]})}),\", for which, in today's computer standards, can be done within an hour or so in a low-end laptop, 20 minutes if running multiple cores. For every \",s(e.code,{children:\"seed\"}),\", we set seed by \",s(e.code,{children:\"rand.Seed(seed)\"}),\" then call \",s(e.code,{children:\"rand.Intn(2023)\"}),\" a few times and compare the outputs with the server's \",s(e.code,{children:\"n\"}),\"(s), which can be obtained for free by keep betting \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"0\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"0\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"0\"})]})})]})}),\" coins. When we've found and verified the \",s(e.code,{children:\"seed\"}),\", we just need to keep betting with our \",s(e.code,{children:\"balance\"}),\" with \",s(e.code,{children:\"n = rand.Intn(2023)\"}),\" to get the flag.\"]}),\"\\n\",n(e.p,{children:[\"While it is very simple to setup the code to do this, an hour, to me, still feels like it's too much. If you code wrong \",s(e.em,{children:\"(probably you won't but who knows?)\"}),\", you would've to spend another hour to debug \",\"üôÇ\",\" Luckily tho, we can find the pattern of \",s(e.code,{children:\"rand.Intn(2023)\"}),\" without the seed \",\"üòâ\",\", thus solving this challenge in a matter of seconds.\"]}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",n(e.h1,{id:\"finding-pattern-in-randintnn\",children:[\"Finding pattern in \",s(e.code,{children:\"rand.Intn(n)\"})]}),\"\\n\",s(e.h2,{id:\"graphing-the-calls\",children:\"Graphing the Calls\"}),\"\\n\",s(e.pre,{className:\"language-go\",children:s(e.code,{className:\"language-go code-highlight\",children:n(e.span,{className:\"code-line\",children:[\"r \",s(e.span,{className:\"token operator\",children:\":=\"}),\" rand\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Intn\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"2023\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]})})}),\"\\n\",n(e.p,{children:[\"Staring at a single line of code won't help a thing. So I decided to use the power of \",s(e.strong,{children:\"ctrl-click-into-a-function-because-it-helps-us-going-back-to-its-definition-and-i-hope-i-could-have-a-better-name-for-this\"}),\" in \",s(e.strong,{children:\"VSCode\"}),\" and dive into the code hierarchy and here is the progress:\"]}),\"\\n\",s(e.img,{src:\"backtracking.png\",alt:\"\"}),\"\\n\",s(e.hr,{}),\"\\n\",n(e.p,{children:[\"As you can see, we've got pretty much everything up until the \",s(e.code,{children:\"Int63()\"}),\" function. To look at the code for that, we need to go to \",s(e.code,{children:\"rng.go\"}),\", which is at the same directory as \",s(e.code,{children:\"rand.go\"}),\" \",n(e.em,{children:[\"(the reason I got this is because my friend found the code for \",s(e.code,{children:\"Int63()\"}),\" at \",s(e.a,{href:\"https://go.dev/src/math/rand/rng.go\",children:\"https://go.dev/src/math/rand/rng.go\"}),\", and I was like wait aren't we also have this file in the system too?)\"]}),\", and we've got the complete picture:\"]}),\"\\n\",s(e.img,{src:\"backtracking_v2.png\",alt:\"\"}),\"\\n\",s(e.hr,{}),\"\\n\",n(e.p,{children:[\"While the above graph looks kinda crazy \",s(e.em,{children:\"(or not, idk...)\"}),\", when we create an abstract map for them, it is actually surprisingly simple if we just focus on the case where \",s(e.code,{children:\"n = 2023\"}),\" or \",s(e.code,{children:\"n\"}),\" is a relatively small number to \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2^{31}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]})]})})]})}),\" in general.\"]}),\"\\n\",s(e.img,{src:\"abstraction.png\",alt:\"\"}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",s(e.h2,{id:\"formualize-it\",children:\"Formualize it\"}),\"\\n\",n(e.p,{children:[\"The graph above can be simplified as a formula in \",s(e.strong,{children:\"Python\"}),\":\"]}),\"\\n\",s(e.pre,{className:\"language-python\",children:s(e.code,{className:\"language-python code-highlight\",children:n(e.span,{className:\"code-line\",children:[\"rand\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"Intn\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"n\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"==\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"rand\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"Uint64\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"&\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"1\"}),s(e.span,{className:\"token operator\",children:\"<<\"}),s(e.span,{className:\"token number\",children:\"63\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"-\"}),\" \",s(e.span,{className:\"token number\",children:\"1\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\">>\"}),\" \",s(e.span,{className:\"token number\",children:\"32\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"%\"}),\" n  \",s(e.span,{className:\"token comment\",children:\"# n is small\"}),\"\\n\"]})})}),\"\\n\",n(e.p,{children:[\"Because taking the last \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"63\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"63\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"63\"})]})})]})}),\" bits then shift \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"32\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"32\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"32\"})]})})]})}),\" bits to the right is equivalent to shift \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"32\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"32\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"32\"})]})})]})}),\" bit to the right and taking the last 31 bits, we can rewrite it like this:\"]}),\"\\n\",s(e.pre,{className:\"language-python\",children:s(e.code,{className:\"language-python code-highlight\",children:n(e.span,{className:\"code-line\",children:[\"rand\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"Intn\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"n\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"==\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"rand\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"Uint64\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\">>\"}),\" \",s(e.span,{className:\"token number\",children:\"32\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"&\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"1\"}),s(e.span,{className:\"token operator\",children:\"<<\"}),s(e.span,{className:\"token number\",children:\"31\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"-\"}),\" \",s(e.span,{className:\"token number\",children:\"1\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"%\"}),\" n\\t \",s(e.span,{className:\"token comment\",children:\"# n is small\"}),\"\\n\"]})})}),\"\\n\",n(e.p,{children:[\"we can see that \",s(e.code,{children:\"& ((1<<31) - 1))\"}),\" is just \",s(e.code,{children:\"%¬†(2**31)\"}),\", so:\"]}),\"\\n\",s(e.pre,{className:\"language-python\",children:s(e.code,{className:\"language-python code-highlight\",children:n(e.span,{className:\"code-line\",children:[\"rand\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"Intn\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"n\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"==\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"rand\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"Uint64\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\">>\"}),\" \",s(e.span,{className:\"token number\",children:\"32\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"%\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"2\"}),s(e.span,{className:\"token operator\",children:\"**\"}),s(e.span,{className:\"token number\",children:\"31\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"%\"}),\" n\\t\\t\\t \",s(e.span,{className:\"token comment\",children:\"# n is small\"}),\"\\n\"]})})}),\"\\n\",n(e.p,{children:[\"This implies if we have two Go programs set to the same \",s(e.code,{children:\"seed\"}),\", one outputting 1 number from \",s(e.code,{children:\"rand.Intn(n)\"}),\" and the other outputting 1 number from \",s(e.code,{children:\"rand.Uint64()\"}),\", then the above equation holds.\"]}),\"\\n\",s(e.hr,{}),\"\\n\",n(e.p,{children:[s(e.div,{}),\"\\n... You're probably wondering why I keep mentioning \",s(e.code,{children:\"n\"}),\" is small in the code comment. Well, the above statement \",s(e.em,{children:\"is not entirely true\"}),\". It only happens in \",s(e.strong,{children:\"high probability\"}),\" for small \",s(e.code,{children:\"n\"}),\". For big \",s(e.code,{children:\"n\"}),\" \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{children:\"<\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"< 2^{31}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),s(e.span,{className:\"mrel\",children:\"<\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]})]})]})]})}),\", \",s(e.code,{children:\"rand.Intn(n)\"}),\" may call \",s(e.code,{children:\"rand.Uint64()\"}),\" multiple times before outputting a number. If we investigate into the \",s(e.code,{children:\"rand.Int31n(n)\"}),\" function,\"]}),\"\\n\",s(e.pre,{className:\"language-go\",children:n(e.code,{className:\"language-go code-highlight\",children:[n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"func\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"r \",s(e.span,{className:\"token operator\",children:\"*\"}),\"Rand\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token function\",children:\"Int31n\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"n \",s(e.span,{className:\"token builtin\",children:\"int32\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token builtin\",children:\"int32\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\tmax \",s(e.span,{className:\"token operator\",children:\":=\"}),\" \",s(e.span,{className:\"token function\",children:\"int32\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"1\"}),\" \",s(e.span,{className:\"token operator\",children:\"<<\"}),\" \",s(e.span,{className:\"token number\",children:\"31\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"-\"}),\" \",s(e.span,{className:\"token number\",children:\"1\"}),\" \",s(e.span,{className:\"token operator\",children:\"-\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"1\"}),s(e.span,{className:\"token operator\",children:\"<<\"}),s(e.span,{className:\"token number\",children:\"31\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token operator\",children:\"%\"}),s(e.span,{className:\"token function\",children:\"uint32\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"n\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\tv \",s(e.span,{className:\"token operator\",children:\":=\"}),\" r\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Int31\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token keyword\",children:\"for\"}),\" v \",s(e.span,{className:\"token operator\",children:\">\"}),\" max \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\\tv \",s(e.span,{className:\"token operator\",children:\"=\"}),\" r\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Int31\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token keyword\",children:\"return\"}),\" v \",s(e.span,{className:\"token operator\",children:\"%\"}),\" n\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]})]})}),\"\\n\",n(e.p,{children:[s(e.div,{}),\"\\nyou can see that there also exists a \",s(e.code,{children:\"max\"}),\" variable, and we have to call \",s(e.code,{children:\"rand.Int31()\"}),\" repeatedly until we hit a value \",s(e.code,{children:\"<=¬†max\"}),\". If \",s(e.code,{children:\"n\"}),\" is small, \",s(e.code,{children:\"max\"}),\" would be very close to \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2^{31}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]})]})})]})}),\", thus we most likely just need to call \",s(e.code,{children:\"rand.Int31()\"}),\" only once for each \",s(e.code,{children:\"rand.Intn(n)\"}),\".\"]}),\"\\n\",n(e.p,{children:[s(e.div,{}),\"\\nOh, but there is an exception if \",s(e.code,{children:\"n\"}),\" is a power of \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"2\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"2\"})]})})]})}),\". If \",s(e.code,{children:\"n\"}),\" is \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mtext,{children:\"something\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2^{\\\\text{something}}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8491em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8491em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord text mtight\",children:s(e.span,{className:\"mord mtight\",children:\"something\"})})})})]})})})})})]})]})})]})}),\", every call to \",s(e.code,{children:\"rand.Intn(n)\"}),\" will definitely call \",s(e.code,{children:\"rand.Int31()\"}),\" once.\"]}),\"\\n\",s(e.pre,{className:\"language-go\",children:n(e.code,{className:\"language-go code-highlight\",children:[n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// Int31n returns, as an int32, a non-negative pseudo-random number in the half-open interval [0,n).\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// It panics if n <= 0.\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"func\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"r \",s(e.span,{className:\"token operator\",children:\"*\"}),\"Rand\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token function\",children:\"Int31n\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"n \",s(e.span,{className:\"token builtin\",children:\"int32\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token builtin\",children:\"int32\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token keyword\",children:\"if\"}),\" n\",s(e.span,{className:\"token operator\",children:\"&\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"n\",s(e.span,{className:\"token operator\",children:\"-\"}),s(e.span,{className:\"token number\",children:\"1\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"==\"}),\" \",s(e.span,{className:\"token number\",children:\"0\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",s(e.span,{className:\"token comment\",children:\"// n is power of two, can mask\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\\t\",s(e.span,{className:\"token keyword\",children:\"return\"}),\" r\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token function\",children:\"Int31\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"&\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"n \",s(e.span,{className:\"token operator\",children:\"-\"}),\" \",s(e.span,{className:\"token number\",children:\"1\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]})]})}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",s(e.h2,{id:\"more-pattern\",children:\"More Pattern\"}),\"\\n\",n(e.p,{children:[\"Consider \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"R\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"R\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"})]})})]})}),\" a list of consecutive outputs from \",s(e.code,{children:\"rand.Intn(n)\"}),\", \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"S\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"S\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"})]})})]})}),\" a list of consecutive outputs from \",s(e.code,{children:\"rand.Uint64()\"}),\" setting to the same \",s(e.code,{children:\"seed\"}),\" starting at the same time, when \",s(e.code,{children:\"n\"}),\" is a small number \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{children:\"<\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"< 2^{31}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),s(e.span,{className:\"mrel\",children:\"<\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]})]})]})]})}),\", we most likely have:\"]}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"‚â´\"}),s(e.mn,{children:\"32\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"R_i = (S_i \\\\gg 32) \\\\mod 2^{31} \\\\mod n\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"32\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8641em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]})]})]})})}),\"\\n\",n(e.p,{children:[\"where \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{separator:\"true\",children:\",\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"S_i, R_i\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8778em\",verticalAlign:\"-0.1944em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]})]})})]})}),\" is the \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"i\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"i\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6595em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"i\"})]})})]})}),\"-th output of \",s(e.code,{children:\"rand.Uint64()\"}),\" and \",s(e.code,{children:\"rand.Intn(n)\"}),\".\"]}),\"\\n\",n(e.p,{children:[s(e.div,{}),\"\\nWhat's great about this formula is that we can now derive a pattern for \",s(e.code,{children:\"rand.Intn(n)\"}),\" through the pattern of \",s(e.code,{children:\"rand.Uint64()\"}),\". And it turns out the pattern of \",s(e.code,{children:\"rand.Uint64()\"}),\" is very simple. When you look at the code for \",s(e.code,{children:\"rand.Uint64()\"}),\", you can see it get output from \",s(e.code,{children:\"rng.vec\"}),\" array while updating it.\"]}),\"\\n\",s(e.pre,{className:\"language-go\",children:n(e.code,{className:\"language-go code-highlight\",children:[n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// /usr/lib/go-1.18/src/math/rand/rng.go\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"const\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\trngLen   \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token number\",children:\"607\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\trngTap   \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token number\",children:\"273\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\trngMax   \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token number\",children:\"1\"}),\" \",s(e.span,{className:\"token operator\",children:\"<<\"}),\" \",s(e.span,{className:\"token number\",children:\"63\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\trngMask  \",s(e.span,{className:\"token operator\",children:\"=\"}),\" rngMax \",s(e.span,{className:\"token operator\",children:\"-\"}),\" \",s(e.span,{className:\"token number\",children:\"1\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\tint32max \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"1\"}),\" \",s(e.span,{className:\"token operator\",children:\"<<\"}),\" \",s(e.span,{className:\"token number\",children:\"31\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"-\"}),\" \",s(e.span,{className:\"token number\",children:\"1\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"type\"}),\" rngSource \",s(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\ttap  \",s(e.span,{className:\"token builtin\",children:\"int\"}),\"           \",s(e.span,{className:\"token comment\",children:\"// index into vec\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\tfeed \",s(e.span,{className:\"token builtin\",children:\"int\"}),\"           \",s(e.span,{className:\"token comment\",children:\"// index into vec\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\tvec  \",s(e.span,{className:\"token punctuation\",children:\"[\"}),\"rngLen\",s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token builtin\",children:\"int64\"}),\" \",s(e.span,{className:\"token comment\",children:\"// current feedback register\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// Seed uses the provided seed value to initialize the generator to a deterministic state.\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"func\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"rng \",s(e.span,{className:\"token operator\",children:\"*\"}),\"rngSource\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token function\",children:\"Seed\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"seed \",s(e.span,{className:\"token builtin\",children:\"int64\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\trng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"tap \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token number\",children:\"0\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\trng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"feed \",s(e.span,{className:\"token operator\",children:\"=\"}),\" rngLen \",s(e.span,{className:\"token operator\",children:\"-\"}),\" rngTap\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// ...\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"// Uint64 returns a non-negative pseudo-random 64-bit integer as an uint64.\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"func\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"rng \",s(e.span,{className:\"token operator\",children:\"*\"}),\"rngSource\",s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token function\",children:\"Uint64\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token builtin\",children:\"uint64\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\trng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"tap\",s(e.span,{className:\"token operator\",children:\"--\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token keyword\",children:\"if\"}),\" rng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"tap \",s(e.span,{className:\"token operator\",children:\"<\"}),\" \",s(e.span,{className:\"token number\",children:\"0\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\\trng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"tap \",s(e.span,{className:\"token operator\",children:\"+=\"}),\" rngLen\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"\\trng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"feed\",s(e.span,{className:\"token operator\",children:\"--\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token keyword\",children:\"if\"}),\" rng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"feed \",s(e.span,{className:\"token operator\",children:\"<\"}),\" \",s(e.span,{className:\"token number\",children:\"0\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\\trng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"feed \",s(e.span,{className:\"token operator\",children:\"+=\"}),\" rngLen\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"\\tx \",s(e.span,{className:\"token operator\",children:\":=\"}),\" rng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"vec\",s(e.span,{className:\"token punctuation\",children:\"[\"}),\"rng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"feed\",s(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",s(e.span,{className:\"token operator\",children:\"+\"}),\" rng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"vec\",s(e.span,{className:\"token punctuation\",children:\"[\"}),\"rng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"tap\",s(e.span,{className:\"token punctuation\",children:\"]\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\trng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"vec\",s(e.span,{className:\"token punctuation\",children:\"[\"}),\"rng\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"feed\",s(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",s(e.span,{className:\"token operator\",children:\"=\"}),\" x\\n\"]}),n(e.span,{className:\"code-line\",children:[\"\\t\",s(e.span,{className:\"token keyword\",children:\"return\"}),\" \",s(e.span,{className:\"token function\",children:\"uint64\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"x\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token punctuation\",children:\"}\"}),\"\\n\"]})]})}),\"\\n\",n(e.p,{children:[\"You don't need to know how the \",s(e.code,{children:\"rng.vec\"}),\" is created to figure out a pattern for \",s(e.code,{children:\"rand.Uint64()\"}),\". Here, you just need to consider it to be a \",s(e.strong,{children:\"bunch of random numbers\"}),\". The important thing you'll need to care is that \",s(e.code,{children:\"rng.vec\"}),\":\"]}),\"\\n\",n(e.ul,{children:[\"\\n\",n(e.li,{children:[\"\\n\",s(e.p,{children:\"only uses the numbers in it to update itself.\"}),\"\\n\"]}),\"\\n\",n(e.li,{children:[\"\\n\",s(e.p,{children:\"the way it creates new number from older ones.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(e.p,{children:[\"If you're familiar with the structure of \",s(e.strong,{children:\"LFSR\"}),\", or \",s(e.strong,{children:\"Linear Feedback Shift Register\"}),\", you would probably recognize this is kinda like that. The terms like \",s(e.strong,{children:\"tap\"}),\" and \",s(e.strong,{children:\"feed\"}),\" make more sense, and you can deduce the following relationship between some of the \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"S_i\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]})]})})]})}),\"(s):\"]}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mtext,{children:\"rngLen\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mtext,{children:\"rngTap\"})]})]}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"64\"})]}),s(e.mspace,{linebreak:\"newline\"}),s(e.mtext,{children:\"or\"}),s(e.mspace,{linebreak:\"newline\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"64\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"S_i = S_{i-\\\\text{rngLen}} + S_{i-\\\\text{rngTap}} \\\\mod 2^{64} \\\\\\\\\\n\\\\text{or} \\\\\\\\\\nS_i = S_{i-607} + S_{i-273} \\\\mod 2^{64}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord text mtight\",children:s(e.span,{className:\"mord mtight\",children:\"rngLen\"})})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord text mtight\",children:s(e.span,{className:\"mord mtight\",children:\"rngTap\"})})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8641em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"64\"})})})]})})})})})]})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord text\",children:s(e.span,{className:\"mord\",children:\"or\"})})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8641em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"64\"})})})]})})})})})]})]})]})]})})}),\"\\n\",s(e.p,{children:n(e.em,{children:[\"(while it is seemingly enough to conclude \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"S_i = S_{i-607} + S_{i-273}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]})]})]})]})}),\" based on the \",s(e.code,{children:\"x := rng.vec[rng.feed] + rng.vec[rng.tap]\"}),\" line, however since \",s(e.code,{children:\"rng.vec\"}),\" is stored in an \",s(e.code,{children:\"int64\"}),\" array, we have to include the\",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mspace,{}),s(e.mspace,{width:\"0.6667em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"64\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mod 2^{64}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0em\"}}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.6667em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"64\"})})})]})})})})})]})]})]})]})}),\" in there.)\"]})}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",s(e.h2,{id:\"the-tale-of-adding-two-numbers\",children:\"The tale of adding two numbers\"}),\"\\n\",n(e.blockquote,{children:[\"\\n\",s(e.p,{children:s(e.em,{children:\"(i think this section is kinda overkill, but whatever -_-)\"})}),\"\\n\"]}),\"\\n\",n(e.p,{children:[\"What happens to the result when we \",n(e.strong,{children:[\"add two \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"b\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"b\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"b\"})]})})]})}),\"-bit numbers\"]}),\" \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"A\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"A\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"A\"})]})})]})}),\" and \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"B\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"B\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"})]})})]})}),\"? Well, sometimes, the \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mi,{children:\"A\"}),s(e.mo,{children:\"+\"}),s(e.mi,{children:\"B\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"A+B\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"A\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"})]})]})]})}),\" fits into a \",n(e.strong,{children:[s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"b\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"b\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"b\"})]})})]})}),\"-bit value\"]}),\". In this case,\"]}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mi,{children:\"A\"}),s(e.mo,{children:\"+\"}),s(e.mi,{children:\"B\"}),s(e.mo,{children:\"=\"}),s(e.mi,{children:\"A\"}),s(e.mo,{children:\"+\"}),s(e.mi,{children:\"B\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mi,{children:\"b\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"A+B = A+B \\\\mod 2^{b}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"A\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"A\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8991em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"b\"})})})]})})})})})]})]})]})]})})}),\"\\n\",s(e.img,{src:\"adding_no_carry.png\",alt:\"\"}),\"\\n\",s(e.p,{children:\"The other times, the result overflows, at most 1 bit into the left. In this case,\"}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mi,{children:\"A\"}),s(e.mo,{children:\"+\"}),s(e.mi,{children:\"B\"}),s(e.mo,{children:\"=\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),s(e.mi,{children:\"A\"}),s(e.mo,{children:\"+\"}),s(e.mi,{children:\"B\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mi,{children:\"b\"})]}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"+\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mi,{children:\"b\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"A + B = (A + B \\\\mod 2^{b}) + 2^b\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"A\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),s(e.span,{className:\"mord mathnormal\",children:\"A\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.1491em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"b\"})})})]})})})})})]}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8991em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"b\"})})]})})})})})]})]})]})]})})}),\"\\n\",s(e.img,{src:\"adding_carry.png\",alt:\"\"}),\"\\n\",n(e.p,{children:[\"What is also interesting when we add two numbers, is that if you ignore some of \",n(e.strong,{children:[s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"m\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"m\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"m\"})]})})]})}),\"-lower bits\"]}),\" at the end, the addition in the higher bits is still true in some cases. This is essentially saying that,\"]}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{stretchy:\"false\",children:\"(\"}),s(e.mi,{children:\"A\"}),s(e.mo,{children:\"+\"}),s(e.mi,{children:\"B\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"‚â´\"}),s(e.mi,{children:\"m\"}),s(e.mo,{children:\"=\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),s(e.mi,{children:\"A\"}),s(e.mo,{children:\"‚â´\"}),s(e.mi,{children:\"m\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),s(e.mi,{children:\"B\"}),s(e.mo,{children:\"‚â´\"}),s(e.mi,{children:\"m\"}),s(e.mo,{stretchy:\"false\",children:\")\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"(A + B) \\\\gg m = (A \\\\gg m) + (B \\\\gg m)\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),s(e.span,{className:\"mord mathnormal\",children:\"A\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"m\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),s(e.span,{className:\"mord mathnormal\",children:\"A\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"m\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"m\"}),s(e.span,{className:\"mclose\",children:\")\"})]})]})]})})}),\"\\n\",s(e.img,{src:\"adding_no_carry_lsb.png\",alt:\"\"}),\"\\n\",n(e.p,{children:[\"However, sometimes, since the addition in the lower \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"m\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"m\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"m\"})]})})]})}),\"-bits \",s(e.em,{children:\"results in a carry\"}),\", we will also get this case:\"]}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{stretchy:\"false\",children:\"(\"}),s(e.mi,{children:\"A\"}),s(e.mo,{children:\"+\"}),s(e.mi,{children:\"B\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"‚â´\"}),s(e.mi,{children:\"m\"}),s(e.mo,{children:\"=\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),s(e.mi,{children:\"A\"}),s(e.mo,{children:\"‚â´\"}),s(e.mi,{children:\"m\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),s(e.mi,{children:\"B\"}),s(e.mo,{children:\"‚â´\"}),s(e.mi,{children:\"m\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"+\"}),s(e.mn,{children:\"1\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"(A+B) \\\\gg m = (A \\\\gg m) + (B \\\\gg m) + 1\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),s(e.span,{className:\"mord mathnormal\",children:\"A\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"m\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),s(e.span,{className:\"mord mathnormal\",children:\"A\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"m\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05017em\"},children:\"B\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"m\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"1\"})]})]})]})})}),\"\\n\",s(e.img,{src:\"adding_carry_lsb.png\",alt:\"\"}),\"\\n\",s(e.h2,{id:\"piecing-the-puzzle-together\",children:\"Piecing the puzzle together\"}),\"\\n\",n(e.blockquote,{children:[\"\\n\",s(e.p,{children:s(e.em,{children:\"(i'm not sure if this reasoning is correct... but I'll try my best)\"})}),\"\\n\"]}),\"\\n\",n(e.blockquote,{children:[\"\\n\",s(e.p,{children:n(e.em,{children:[\"(at first I was going to use the figures similar to the previous section but I don't know how, so I just stick with the formula, hope this make senses to all of you \",\"üôÇ\",\")\"]})}),\"\\n\"]}),\"\\n\",s(e.p,{children:\"You're probably know where this is going. Because:\"}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"64\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"S_i = S_{i-607} + S_{i-273} \\\\mod 2^{64}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8641em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"64\"})})})]})})})})})]})]})]})]})})}),\"\\n\",s(e.p,{children:\"... we have:\"}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"{\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"64\"})]}),s(e.mo,{stretchy:\"false\",children:\"}\"}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"S_i + \\\\{0, 2^{64}\\\\} = S_{i-607} + S_{i-273}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.1141em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"{\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"64\"})})})]})})})})})]}),s(e.span,{className:\"mclose\",children:\"}\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]})]})]})]})})}),\"\\n\",n(e.blockquote,{children:[\"\\n\",s(e.p,{children:n(e.em,{children:[\"(i dunno if the notation \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"{\"}),s(e.mi,{children:\"a\"}),s(e.mo,{separator:\"true\",children:\",\"}),s(e.mi,{children:\"b\"}),s(e.mo,{stretchy:\"false\",children:\"}\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"+ \\\\{a, b\\\\}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"+\"}),s(e.span,{className:\"mopen\",children:\"{\"}),s(e.span,{className:\"mord mathnormal\",children:\"a\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"b\"}),s(e.span,{className:\"mclose\",children:\"}\"})]})})]})}),\" actually represents \",n(e.strong,{children:[\"add \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"a\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"a\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"a\"})]})})]})})]}),\" \",s(e.strong,{children:\"or\"}),\" \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"b\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"b\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"b\"})]})})]})}),\" or not... But that's what I meant :))\"]})}),\"\\n\"]}),\"\\n\",n(e.p,{children:[\"... shift right both sides by \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"32\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"32\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"32\"})]})})]})}),\"...\"]}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{stretchy:\"false\",children:\"(\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"‚â´\"}),s(e.mn,{children:\"32\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"{\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"32\"})]}),s(e.mo,{stretchy:\"false\",children:\"}\"}),s(e.mo,{children:\"=\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"‚â´\"}),s(e.mn,{children:\"32\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mo,{children:\"‚â´\"}),s(e.mn,{children:\"32\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"{\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),s(e.mn,{children:\"1\"}),s(e.mo,{stretchy:\"false\",children:\"}\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"(S_i \\\\gg 32) + \\\\{0, 2^{32}\\\\} = (S_{i-607} \\\\gg 32) + (S_{i-273} \\\\gg 32) + \\\\{0,1\\\\}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"32\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.1141em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"{\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"32\"})})})]})})})})})]}),s(e.span,{className:\"mclose\",children:\"}\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"32\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"32\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"{\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord\",children:\"1\"}),s(e.span,{className:\"mclose\",children:\"}\"})]})]})]})})}),\"\\n\",n(e.p,{children:[\"... and we reduce both sides\",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mspace,{}),s(e.mspace,{width:\"0.6667em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mod 2^{31}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0em\"}}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.6667em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]})]})]})]})}),\"...\"]}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{stretchy:\"false\",children:\"(\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"‚â´\"}),s(e.mn,{children:\"32\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mo,{children:\"=\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"‚â´\"}),s(e.mn,{children:\"32\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mo,{children:\"‚â´\"}),s(e.mn,{children:\"32\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"{\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),s(e.mn,{children:\"1\"}),s(e.mo,{stretchy:\"false\",children:\"}\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"(S_i \\\\gg 32) \\\\mod 2^{31} = (S_{i-607} \\\\gg 32) + (S_{i-273} \\\\gg 32) + \\\\{0,1\\\\} \\\\mod 2^{31}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"32\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8641em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"32\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"32\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"{\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord\",children:\"1\"}),s(e.span,{className:\"mclose\",children:\"}\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8641em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]})]})]})]})})}),\"\\n\",n(e.blockquote,{children:[\"\\n\",s(e.p,{children:n(e.em,{children:[\"(\",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{stretchy:\"false\",children:\"{\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"32\"})]}),s(e.mo,{stretchy:\"false\",children:\"}\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\{0, 2^{32}\\\\}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.0641em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"{\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"32\"})})})]})})})})})]}),s(e.span,{className:\"mclose\",children:\"}\"})]})})]})}),\" vanishes cuz \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"0\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"0\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"0\"})]})})]})}),\" or \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"32\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2^{32}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"32\"})})})]})})})})})]})]})})]})}),\" equals \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"0\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"0\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"0\"})]})})]})}),\" mod \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2^{31}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]})]})})]})}),\")\"]})}),\"\\n\"]}),\"\\n\",s(e.p,{children:\"But this also means:\"}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{stretchy:\"false\",children:\"(\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"‚â´\"}),s(e.mn,{children:\"32\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mo,{children:\"=\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"‚â´\"}),s(e.mn,{children:\"32\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),s(e.mo,{stretchy:\"false\",children:\"(\"}),n(e.msub,{children:[s(e.mi,{children:\"S\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mo,{children:\"‚â´\"}),s(e.mn,{children:\"32\"}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mo,{stretchy:\"false\",children:\")\"}),s(e.mo,{children:\"‚àí\"}),s(e.mo,{stretchy:\"false\",children:\"{\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mo,{stretchy:\"false\",children:\"}\"}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"{\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),s(e.mn,{children:\"1\"}),s(e.mo,{stretchy:\"false\",children:\"}\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"(S_i \\\\gg 32) \\\\mod 2^{31} = ((S_{i-607} \\\\gg 32) \\\\mod 2^{31}) + ((S_{i-273} \\\\gg 32) \\\\mod 2^{31}) - \\\\{0, 2^{31}\\\\} + \\\\{0,1\\\\}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"(\"}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"32\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8641em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"((\"}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"32\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.1141em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"((\"}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0576em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"‚â´\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:\"32\"}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.1141em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mclose\",children:\")\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"‚àí\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.1141em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"{\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mclose\",children:\"}\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"{\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord\",children:\"1\"}),s(e.span,{className:\"mclose\",children:\"}\"})]})]})]})})}),\"\\n\",n(e.p,{children:[\"Now the final ingredient, taking\",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mspace,{}),s(e.mspace,{width:\"0.6667em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mod n\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0em\"}}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.6667em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]})]})]})}),\" on both sides, and \",s(e.strong,{children:\"voil√†!\"}),\":\"]}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mo,{children:\"‚àí\"}),s(e.mo,{stretchy:\"false\",children:\"{\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mo,{stretchy:\"false\",children:\"}\"}),s(e.mo,{children:\"+\"}),s(e.mo,{stretchy:\"false\",children:\"{\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),s(e.mn,{children:\"1\"}),s(e.mo,{stretchy:\"false\",children:\"}\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"R_i = R_{i-607} + R_{i-273} - \\\\{0, 2^{31}\\\\} + \\\\{0, 1\\\\} \\\\mod n\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"‚àí\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.1141em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"{\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mclose\",children:\"}\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"{\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord\",children:\"1\"}),s(e.span,{className:\"mclose\",children:\"}\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]})]})]})})}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",n(e.h2,{id:\"take-your-balance-to-the-infinity-and-beyond-\",children:[\"Take your \",s(e.code,{children:\"balance\"}),\" to the infinity and beyond \",\"üöÄ\"]}),\"\\n\",n(e.p,{children:[\"Now we've known how the outputs of \",s(e.code,{children:\"rand.Intn(n)\"}),\" are related. We can collect numbers generated by the server into a list \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mi,{children:\"R\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"R\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"})]})})]})}),\" by just \",s(e.strong,{children:\"betting\"}),\" random numbers in \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[n(e.mrow,{children:[s(e.mo,{stretchy:\"false\",children:\"[\"}),s(e.mn,{children:\"0\"}),s(e.mo,{separator:\"true\",children:\",\"}),s(e.mn,{children:\"2023\"}),s(e.mo,{stretchy:\"false\",children:\")\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"[0, 2023)\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),s(e.span,{className:\"mopen\",children:\"[\"}),s(e.span,{className:\"mord\",children:\"0\"}),s(e.span,{className:\"mpunct\",children:\",\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord\",children:\"2023\"}),s(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\". You can bet \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"0\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"0\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"0\"})]})})]})}),\" coin units to prevent yourself from losing money.\"]}),\"\\n\",n(e.p,{children:[\"After \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"607\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"607\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"607\"})]})})]})}),\" numbers are collected, you choose from one of the 4 possibilities that states either the next output \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"R_i\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]})]})})]})}),\" is:\"]}),\"\\n\",s(e.div,{className:\"math math-display\",children:s(e.span,{className:\"katex-display\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:n(e.semantics,{children:[n(e.mrow,{children:[n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"}),s(e.mspace,{linebreak:\"newline\"}),s(e.mtext,{children:\"or\"}),s(e.mspace,{linebreak:\"newline\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mo,{children:\"+\"}),s(e.mn,{children:\"1\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"}),s(e.mspace,{linebreak:\"newline\"}),s(e.mtext,{children:\"or\"}),s(e.mspace,{linebreak:\"newline\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mo,{children:\"‚àí\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"}),s(e.mspace,{linebreak:\"newline\"}),s(e.mtext,{children:\"or\"}),s(e.mspace,{linebreak:\"newline\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]}),s(e.mo,{children:\"=\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"607\"})]})]}),s(e.mo,{children:\"+\"}),n(e.msub,{children:[s(e.mi,{children:\"R\"}),n(e.mrow,{children:[s(e.mi,{children:\"i\"}),s(e.mo,{children:\"‚àí\"}),s(e.mn,{children:\"273\"})]})]}),s(e.mo,{children:\"‚àí\"}),n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"31\"})]}),s(e.mo,{children:\"+\"}),s(e.mn,{children:\"1\"}),s(e.mspace,{}),s(e.mspace,{width:\"1em\"}),n(e.mrow,{children:[s(e.mi,{mathvariant:\"normal\",children:\"m\"}),s(e.mi,{mathvariant:\"normal\",children:\"o\"}),s(e.mi,{mathvariant:\"normal\",children:\"d\"})]}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mtext,{children:\"‚Äâ\"}),s(e.mi,{children:\"n\"})]}),s(e.annotation,{encoding:\"application/x-tex\",children:\"R_i = R_{i-607} + R_{i-273} \\\\mod {n}\\n\\\\\\\\ \\\\text{or} \\\\\\\\\\nR_i = R_{i-607} + R_{i-273} + 1 \\\\mod {n}\\n\\\\\\\\ \\\\text{or} \\\\\\\\\\nR_i = R_{i-607} + R_{i-273} - 2^{31} \\\\mod {n}\\n\\\\\\\\ \\\\text{or} \\\\\\\\\\nR_i = R_{i-607} + R_{i-273} - 2^{31} + 1 \\\\mod {n}\"})]})})}),n(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord text\",children:s(e.span,{className:\"mord\",children:\"or\"})})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"1\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord text\",children:s(e.span,{className:\"mord\",children:\"or\"})})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"‚àí\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8641em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),s(e.span,{className:\"mord text\",children:s(e.span,{className:\"mord\",children:\"or\"})})]}),s(e.span,{className:\"mspace newline\"}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),s(e.span,{className:\"mrel\",children:\"=\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"607\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8917em\",verticalAlign:\"-0.2083em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:n(e.span,{className:\"mord mtight\",children:[s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),s(e.span,{className:\"mbin mtight\",children:\"‚àí\"}),s(e.span,{className:\"mord mtight\",children:\"273\"})]})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:s(e.span,{})})})]})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"‚àí\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.9474em\",verticalAlign:\"-0.0833em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:n(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"31\"})})})]})})})})})]}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),s(e.span,{className:\"mbin\",children:\"+\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"1\"}),s(e.span,{className:\"mspace allowbreak\"}),s(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]}),n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord\",children:s(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),s(e.span,{className:\"mord mathnormal\",children:\"n\"})]})]})]})})}),\"\\n\",n(e.p,{children:[\"and bet \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msub,{children:[s(e.mi,{children:\"R\"}),s(e.mi,{children:\"i\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"R_i\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),s(e.span,{className:\"msupsub\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[s(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:n(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:s(e.span,{})})})]})})]})]})})]})}),\" with that guess.\"]}),\"\\n\",n(e.p,{children:[\"Because win amount is \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:s(e.mn,{children:\"2022\"})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2022\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),s(e.span,{className:\"mord\",children:\"2022\"})]})})]})}),\" times bigger than lose amount, while our possibility of hitting the correct answer is \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.mfrac,{children:[s(e.mn,{children:\"1\"}),s(e.mn,{children:\"4\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\frac{1}{4}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"1.1901em\",verticalAlign:\"-0.345em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mopen nulldelimiter\"}),s(e.span,{className:\"mfrac\",children:n(e.span,{className:\"vlist-t vlist-t2\",children:[n(e.span,{className:\"vlist-r\",children:[n(e.span,{className:\"vlist\",style:{height:\"0.8451em\"},children:[n(e.span,{style:{top:\"-2.655em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"4\"})})})]}),n(e.span,{style:{top:\"-3.23em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),s(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),n(e.span,{style:{top:\"-3.394em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),s(e.span,{className:\"vlist-s\",children:\"‚Äã\"})]}),s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.345em\"},children:s(e.span,{})})})]})}),s(e.span,{className:\"mclose nulldelimiter\"})]})]})})]})}),\", our money will be increasing in the long run. If we bet with some \",s(e.code,{children:\"amount\"}),\" that is proportional to \",s(e.code,{children:\"balance\"}),\" like \",s(e.code,{children:\"balance\"}),\"/2, this allows our money to grow exponentially, makes it easy to hit some crazy big number like \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"400\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2^{400}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"400\"})})})]})})})})})]})]})})]})}),\" in no time.\"]}),\"\\n\",n(e.blockquote,{children:[\"\\n\",s(e.p,{children:n(e.em,{children:[\"(i'm not sure that's optimal or not... but \",s(e.code,{children:\"balance\"}),\"/2 works so I don't think too much about that \",\"üôÇ\",\")\"]})}),\"\\n\"]}),\"\\n\",n(e.p,{children:[\"When you get \",s(e.span,{className:\"math math-inline\",children:n(e.span,{className:\"katex\",children:[s(e.span,{className:\"katex-mathml\",children:s(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:n(e.semantics,{children:[s(e.mrow,{children:n(e.msup,{children:[s(e.mn,{children:\"2\"}),s(e.mn,{children:\"400\"})]})}),s(e.annotation,{encoding:\"application/x-tex\",children:\"2^{400}\"})]})})}),s(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:n(e.span,{className:\"base\",children:[s(e.span,{className:\"strut\",style:{height:\"0.8141em\"}}),n(e.span,{className:\"mord\",children:[s(e.span,{className:\"mord\",children:\"2\"}),s(e.span,{className:\"msupsub\",children:s(e.span,{className:\"vlist-t\",children:s(e.span,{className:\"vlist-r\",children:s(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:n(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[s(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),s(e.span,{className:\"sizing reset-size6 size3 mtight\",children:s(e.span,{className:\"mord mtight\",children:s(e.span,{className:\"mord mtight\",children:\"400\"})})})]})})})})})]})]})})]})}),\" coin units, you request \",s(e.code,{children:\"showBalanceWithProof\"}),\" to get \",s(e.code,{children:\"proofData\"}),\" then submit it along with your \",s(e.code,{children:\"balance\"}),\" to \",s(e.code,{children:\"PrintFlag\"}),\" to grab some flag! \",s(e.em,{children:\"(yey)\"})]}),\"\\n\",s(e.p,{children:s(e.div,{})}),\"\\n\",s(e.h1,{id:\"appendices\",children:\"Appendices\"}),\"\\n\",s(e.h2,{id:\"solve-script\",children:\"Solve script\"}),\"\\n\",s(e.pre,{className:\"language-python\",children:n(e.code,{className:\"language-python code-highlight\",children:[n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"from\"}),\"   tqdm     \",s(e.span,{className:\"token keyword\",children:\"import\"}),\" trange\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"from\"}),\"   pwn      \",s(e.span,{className:\"token keyword\",children:\"import\"}),\" remote\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"from\"}),\"   sage\",s(e.span,{className:\"token punctuation\",children:\".\"}),s(e.span,{className:\"token builtin\",children:\"all\"}),\" \",s(e.span,{className:\"token keyword\",children:\"import\"}),\" \",s(e.span,{className:\"token operator\",children:\"*\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"import\"}),\" base64\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"import\"}),\" json\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"host \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token string\",children:\"'192.53.115.129'\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"port \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token builtin\",children:\"int\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"31339\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"########## Connect ###########\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"io \",s(e.span,{className:\"token operator\",children:\"=\"}),\" remote\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"host\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" port\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"# io = process(['./src/casino'])\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"def\"}),\" \",s(e.span,{className:\"token function\",children:\"request\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"if\"}),\" \",s(e.span,{className:\"token builtin\",children:\"isinstance\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token builtin\",children:\"str\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"        data \",s(e.span,{className:\"token operator\",children:\"=\"}),\" data\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"encode\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"elif\"}),\" \",s(e.span,{className:\"token keyword\",children:\"not\"}),\" \",s(e.span,{className:\"token builtin\",children:\"isinstance\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token builtin\",children:\"bytes\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"        data \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token builtin\",children:\"str\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\".\"}),\"encode\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    io\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"send_raw\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"data \",s(e.span,{className:\"token operator\",children:\"+\"}),\" \",s(e.span,{className:\"token string\",children:\"b'\\\\n'\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"def\"}),\" \",s(e.span,{className:\"token function\",children:\"recvline\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" io\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"recvline\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\".\"}),\"strip\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\".\"}),\"decode\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"def\"}),\" \",s(e.span,{className:\"token function\",children:\"get\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    request\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"json\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"dumps\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" recvline\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"########### Requests #############\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"def\"}),\" \",s(e.span,{className:\"token function\",children:\"register\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" get\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"                \",s(e.span,{className:\"token string\",children:'\"Recipient\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Casino\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"                \",s(e.span,{className:\"token string\",children:'\"Command\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Register\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"                \",s(e.span,{className:\"token string\",children:'\"Username\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" username\\n\"]}),n(e.span,{className:\"code-line\",children:[\"            \",s(e.span,{className:\"token punctuation\",children:\"}\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"def\"}),\" \",s(e.span,{className:\"token function\",children:\"bet\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" amount\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" number\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    answer \",s(e.span,{className:\"token operator\",children:\"=\"}),\" get\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"        \",s(e.span,{className:\"token string\",children:'\"Recipient\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Casino\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"        \",s(e.span,{className:\"token string\",children:'\"Command\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Bet\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"        \",s(e.span,{className:\"token string\",children:'\"Username\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" username\",s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"        \",s(e.span,{className:\"token string\",children:'\"Amount\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" amount\",s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"        \",s(e.span,{className:\"token string\",children:'\"N\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" number\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token punctuation\",children:\"}\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"    serverGuess \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token builtin\",children:\"int\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"answer\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:\"' '\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token number\",children:\"2\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token number\",children:\"1\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token keyword\",children:\"if\"}),\" \",s(e.span,{className:\"token string\",children:\"'YOU WIN'\"}),\" \",s(e.span,{className:\"token keyword\",children:\"not\"}),\" \",s(e.span,{className:\"token keyword\",children:\"in\"}),\" answer \",s(e.span,{className:\"token keyword\",children:\"else\"}),\" number\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    ourBalance  \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token builtin\",children:\"int\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"answer\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:\"' '\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token operator\",children:\"-\"}),s(e.span,{className:\"token number\",children:\"2\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" serverGuess\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" ourBalance\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"def\"}),\" \",s(e.span,{className:\"token function\",children:\"showBalance\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    answer \",s(e.span,{className:\"token operator\",children:\"=\"}),\" get\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"        \",s(e.span,{className:\"token string\",children:'\"Recipient\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"Casino\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"        \",s(e.span,{className:\"token string\",children:'\"Command\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"ShowBalanceWithProof\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"        \",s(e.span,{className:\"token string\",children:'\"Username\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" username\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token punctuation\",children:\"}\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"    ourBalance \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token builtin\",children:\"int\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"answer\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:\"' '\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token number\",children:\"0\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),s(e.span,{className:\"token operator\",children:\"-\"}),s(e.span,{className:\"token number\",children:\"1\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    proofBytes \",s(e.span,{className:\"token operator\",children:\"=\"}),\" base64\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"b64decode\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"answer\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string\",children:\"' '\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token number\",children:\"1\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" ourBalance\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" proofBytes\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"def\"}),\" \",s(e.span,{className:\"token function\",children:\"printFlag\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"username\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" balance\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" proof\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"return\"}),\" get\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"                \",s(e.span,{className:\"token string\",children:'\"Recipient\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"FlagSeller\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"                \",s(e.span,{className:\"token string\",children:'\"Command\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" \",s(e.span,{className:\"token string\",children:'\"PrintFlag\"'}),s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"                \",s(e.span,{className:\"token string\",children:'\"Username\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" username\",s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"                \",s(e.span,{className:\"token string\",children:'\"Balance\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" balance\",s(e.span,{className:\"token punctuation\",children:\",\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"                \",s(e.span,{className:\"token string\",children:'\"proof_data\"'}),s(e.span,{className:\"token punctuation\",children:\":\"}),\" \",s(e.span,{className:\"token builtin\",children:\"list\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"proof\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"            \",s(e.span,{className:\"token punctuation\",children:\"}\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"    \\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"########### Main #############\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"USER \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token string\",children:\"'mistsu'\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"register\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"USER\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"print\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string-interpolation\",children:s(e.span,{className:\"token string\",children:\"f'[i] Collecting server outputs...'\"})}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"serverOutputs \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"[\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",s(e.span,{className:\"token keyword\",children:\"in\"}),\" trange\",s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"607\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    serverOutput\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" balance \",s(e.span,{className:\"token operator\",children:\"=\"}),\" bet\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"USER\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"0\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" \",s(e.span,{className:\"token number\",children:\"0\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    serverOutputs\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"serverOutput\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"print\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string-interpolation\",children:s(e.span,{className:\"token string\",children:\"f'[i] Guessing server\\\\'s outputs with probability of 1/4...'\"})}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"i \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token number\",children:\"607\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"while\"}),\" balance \",s(e.span,{className:\"token operator\",children:\"<\"}),\" \",s(e.span,{className:\"token number\",children:\"2\"}),s(e.span,{className:\"token operator\",children:\"**\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token number\",children:\"50\"}),s(e.span,{className:\"token operator\",children:\"*\"}),s(e.span,{className:\"token number\",children:\"8\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\":\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    ourGuess \",s(e.span,{className:\"token operator\",children:\"=\"}),\" \",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"serverOutputs\",s(e.span,{className:\"token punctuation\",children:\"[\"}),\"i \",s(e.span,{className:\"token operator\",children:\"-\"}),\" \",s(e.span,{className:\"token number\",children:\"607\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",s(e.span,{className:\"token operator\",children:\"+\"}),\" serverOutputs\",s(e.span,{className:\"token punctuation\",children:\"[\"}),\"i \",s(e.span,{className:\"token operator\",children:\"-\"}),\" \",s(e.span,{className:\"token number\",children:\"273\"}),s(e.span,{className:\"token punctuation\",children:\"]\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\" \",s(e.span,{className:\"token operator\",children:\"%\"}),\" \",s(e.span,{className:\"token number\",children:\"2023\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    serverOutput\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" balance \",s(e.span,{className:\"token operator\",children:\"=\"}),\" bet\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"USER\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" balance\",s(e.span,{className:\"token operator\",children:\"//\"}),s(e.span,{className:\"token number\",children:\"2\"}),s(e.span,{className:\"token punctuation\",children:\",\"}),\" ourGuess\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    serverOutputs\",s(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"serverOutput\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"print\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),n(e.span,{className:\"token string-interpolation\",children:[s(e.span,{className:\"token string\",children:\"f'[i] Server actual output: \"}),n(e.span,{className:\"token interpolation\",children:[s(e.span,{className:\"token punctuation\",children:\"{\"}),\"serverOutput\",s(e.span,{className:\"token punctuation\",children:\"}\"})]}),s(e.span,{className:\"token string\",children:\"'\"})]}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"print\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),n(e.span,{className:\"token string-interpolation\",children:[s(e.span,{className:\"token string\",children:\"f'[i] Our output:           \"}),n(e.span,{className:\"token interpolation\",children:[s(e.span,{className:\"token punctuation\",children:\"{\"}),\"ourGuess\",s(e.span,{className:\"token punctuation\",children:\"}\"})]}),s(e.span,{className:\"token string\",children:\"'\"})]}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"print\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),n(e.span,{className:\"token string-interpolation\",children:[s(e.span,{className:\"token string\",children:\"f'[i] Balance:              \"}),n(e.span,{className:\"token interpolation\",children:[s(e.span,{className:\"token punctuation\",children:\"{\"}),\"balance\",s(e.span,{className:\"token punctuation\",children:\"}\"})]}),s(e.span,{className:\"token string\",children:\"'\"})]}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[\"    \",s(e.span,{className:\"token keyword\",children:\"print\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),s(e.span,{className:\"token string-interpolation\",children:s(e.span,{className:\"token string\",children:\"f'---------------------------------------------------'\"})}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"    i \",s(e.span,{className:\"token operator\",children:\"+=\"}),\" \",s(e.span,{className:\"token number\",children:\"1\"}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[\"ourBalance\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" proofBytes \",s(e.span,{className:\"token operator\",children:\"=\"}),\" showBalance\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"USER\",s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token keyword\",children:\"print\"}),s(e.span,{className:\"token punctuation\",children:\"(\"}),\"printFlag\",s(e.span,{className:\"token punctuation\",children:\"(\"}),\"USER\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" ourBalance\",s(e.span,{className:\"token punctuation\",children:\",\"}),\" proofBytes\",s(e.span,{className:\"token punctuation\",children:\")\"}),s(e.span,{className:\"token punctuation\",children:\")\"}),\"\\n\"]})]})}),\"\\n\",s(e.h2,{id:\"modifying-dockerfile\",children:\"Modifying dockerfile\"}),\"\\n\",n(e.p,{children:[\"Yeah, building a docker for this challenge sucks, because it keeps yelling at us that there's no \",s(e.code,{children:\"go.sum\"}),\" file :< So we decided to fix the \",s(e.code,{children:\"Dockerfile\"}),\", add a \",s(e.code,{children:\"compose.yml\"}),\" file so that we can just \",s(e.code,{children:\"docker compose\"}),\" it, making our lives easier \",\"üôÇ\",\" . Here are them 2 files:\"]}),\"\\n\",s(e.h3,{id:\"dockerfile-modified\",children:\"Dockerfile (modified)\"}),\"\\n\",s(e.pre,{className:\"language-dockerfile\",children:n(e.code,{className:\"language-dockerfile code-highlight\",children:[n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"FROM\"}),\" golang:1.19-alpine\"]}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"RUN\"}),\" apk add socat\"]}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"RUN\"}),\" addgroup -S casino && adduser -S casino -G casino\"]}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"USER\"}),\" casino:casino\"]}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"WORKDIR\"}),\" /home/casino\"]}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"# Create go.mod file\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"COPY\"}),\" ./go.mod .\"]}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"RUN\"}),\" go mod download\"]}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"# This is just for a reminder to put a flag file in here :)\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"COPY\"}),\" ./flag .  \"]}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[s(e.span,{className:\"token comment\",children:\"# Copy everything else and build binary.\"}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"COPY\"}),\" . .\"]}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"RUN\"}),\" go get casino \"]}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"RUN\"}),\" mkdir ./build\"]}),\"\\n\"]}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"RUN\"}),\" go build -o ./build/casino\"]}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"EXPOSE\"}),\" 31339\"]}),\"\\n\"]}),s(e.span,{className:\"code-line\",children:\"\\n\"}),n(e.span,{className:\"code-line\",children:[n(e.span,{className:\"token instruction\",children:[s(e.span,{className:\"token keyword\",children:\"CMD\"}),\" socat -T 30 -d -d TCP-LISTEN:31339,reuseaddr,fork EXEC:\",s(e.span,{className:\"token string\",children:'\"./build/casino\"'})]}),\"\\n\"]})]})}),\"\\n\",s(e.h3,{id:\"composeyml\",children:\"compose.yml\"}),\"\\n\",s(e.pre,{children:n(e.code,{className:\"code-highlight\",children:[s(e.span,{className:\"code-line\",children:\"services:\\n\"}),s(e.span,{className:\"code-line\",children:\"    casino2:\\n\"}),s(e.span,{className:\"code-line\",children:\"        build: .\\n\"}),s(e.span,{className:\"code-line\",children:\"        ports:\\n\"}),s(e.span,{className:\"code-line\",children:'            - \"31339:31339\"\\n'})]})}),\"\\n\",n(e.p,{children:[\"After starting the container, you can connect to \",s(e.code,{children:\"localhost:31339\"}),\" to play the challenge \",\"üòó\"]})]})}return{default:function(e={}){var a=Object.assign({},l(),e.components)[\"wrapper\"];return a?s(a,Object.assign({},e,{children:s(c,e)})):c(e)}};","frontmatter":{},"scope":{}},"prevPost":{"title":"Midnightsun CTF 2023 - IKEA","date":"2023-04-12T07:00:00+07:00","description":"Lately, I haven't been playing CTFs much... So I was kinda dumb on everything.\nAnyways, I encouter a nice RSA Crypto challenge on MidnightCTF.\n","coverImage":"cover.png","minsRead":4,"draft":false,"noWords":843,"permalink":"https://cryptsu.github.io/posts/midnightsun-2023/","slug":"midnightsun-2023"},"nextPost":{"title":"Glitch in the matrix 2.0 - ISITDTU 2022 Quals - Writeup","date":"2022-11-17T04:07:00+07:00","description":"Probability and whatnot...","coverImage":"cover.png","minsRead":16,"draft":false,"noWords":3182,"permalink":"https://cryptsu.github.io/posts/glitch-in-the-matrix-isitdtu-2022-quals/","slug":"glitch-in-the-matrix-isitdtu-2022-quals"}},"__N_SSG":true}